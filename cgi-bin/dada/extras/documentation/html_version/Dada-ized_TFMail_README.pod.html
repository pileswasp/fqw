<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Dada-ized TFmail</title>
<link rel="stylesheet" href="/Users/justin/Documents/DadaMail/build/tmp/dada/extras/documentation/pod_source/pod_styles.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:vxd@glow.apple.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME-Dada-ized-TFmail">NAME Dada-ized TFmail</a></li>
  <li><a href="#SUMMDESCRIPTIONARY">SUMMDESCRIPTIONARY</a></li>
  <li><a href="#ORIGINAL-SOURCE">ORIGINAL SOURCE</a></li>
  <li><a href="#OBTAINING-Dada-ized-TFmail.pl">OBTAINING Dada-ized TFmail.pl</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
  <li><a href="#LICENSE">LICENSE</a></li>
  <li><a href="#URL">URL</a></li>
  <li><a href="#FILES">FILES</a></li>
  <li><a href="#SCRIPT-CONFIGURATION">SCRIPT CONFIGURATION</a></li>
  <li><a href="#SCRIPT-INSTALLATION">SCRIPT INSTALLATION</a></li>
  <li><a href="#CHOOSING-SECURE-LOCATIONS-FOR-FILES">CHOOSING SECURE LOCATIONS FOR FILES</a></li>
  <li><a href="#THE-CONFIGURATION-SCRIPT">THE CONFIGURATION SCRIPT</a></li>
  <li><a href="#OUTPUT-CUSTOMIZATION">OUTPUT CUSTOMIZATION</a></li>
  <li><a href="#CONFIGURATION-FILES">CONFIGURATION FILES</a></li>
  <li><a href="#Dada-Mail-Hooks-in-the-Configuration-Files">Dada Mail Hooks in the Configuration Files</a></li>
  <li><a href="#Reqular-Expressions-for-Required-Form-Fields-in-Configuration-Files">Reqular Expressions for Required Form Fields in Configuration Files</a></li>
  <li><a href="#INLINE-TEMPLATES">INLINE TEMPLATES</a></li>
  <li><a href="#WRITING-TO-A-LOG-FILE">WRITING TO A LOG FILE</a></li>
  <li><a href="#FILE-UPLOADS">FILE UPLOADS</a></li>
  <li><a href="#INSERTING-TEXT-INTO-HTML-FILES">INSERTING TEXT INTO HTML FILES</a></li>
  <li><a href="#ADVANCED-GUESTBOOK">ADVANCED GUESTBOOK</a></li>
  <li><a href="#SUPPORT">SUPPORT</a></li>
</ul>

<h1 id="NAME-Dada-ized-TFmail">NAME Dada-ized TFmail</h1>

<h1 id="SUMMDESCRIPTIONARY">SUMMDESCRIPTIONARY</h1>

<p>This CGI script converts form input to an email message. It gets its configuration from a configuration file, and uses a minimal templating system to generate output HTML and the email message bodies.</p>

<p>It <b>also</b> allows you to either subscribe or, send a email subscription confirmation to the email address passed to this script from the form that called it, via it&#39;s spiffy Dada Mail hooks.</p>

<p>Finally, there has been some simple regular expression checks on the required form fields, to help in warding off any &#39;bots that may in fact be trying to fill out your forms.</p>

<p>TFmail is *not* a plug-in replacement for FormMail.pl, although it has a lot of the same features. TFmail is configured via text files on the server rather than via hidden form fields, has templates for output, and can support HTTP file uploads.</p>

<h1 id="ORIGINAL-SOURCE">ORIGINAL SOURCE</h1>

<p>This copy of the Dada-ized TFmail.pl is based on the NMS TFmail, version 1.38, which may be downloaded at:</p>

<p><a href="http://nms-cgi.sourceforge.net/scripts.shtml">http://nms-cgi.sourceforge.net/scripts.shtml</a></p>

<h1 id="OBTAINING-Dada-ized-TFmail.pl">OBTAINING Dada-ized TFmail.pl</h1>

<p>Dada-ized TFmail.pl is located in the, <i>dada/extensions/tfmail</i> directory of the main Dada Mail distribution, under the name, <b>TFmail.pl</b></p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>(original):</p>

<p>TFMail Copyright 2002 - 2004 London Perl Mongers, All rights reserved</p>

<p>The file MIME_Lite.pm is copyright ZeeGee Software Inc, see the file for details.</p>

<p>Additions and tweaks made by Justin Simoni to add Dada Mail hooks and a simple regular expression check on form field values.</p>

<h1 id="LICENSE">LICENSE</h1>

<p>This script is free software; you are free to redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1 id="URL">URL</h1>

<p>The most up to date version of this script is available from the nms script archive at &lt;http://nms-cgi.sourceforge.net/&gt;</p>

<h1 id="FILES">FILES</h1>

<p>In this distribution, you will find the following files:</p>

<ul>

<li><p>Dada-ized_TFMail_README.pod</p>

<p>Instructions on hot to install and use the Dada-ized TFmail</p>

</li>
<li><p>TFmail.pl</p>

<p>The main Perl script</p>

</li>
<li><p>TFmail_config.pl</p>

<p>A script to help with setting up the configuration files.</p>

</li>
<li><p>GBview.pl</p>

<p>A script that allows TFmail to function as a guestbook</p>

</li>
<li><p>NMStreq.pm</p>

<p>A Perl module that TFmail.pl needs</p>

</li>
<li><p>NMSCharset.pm</p>

<p>Another Perl module that TFmail.pl needs</p>

</li>
<li><p>MIME_Lite.pm</p>

<p>A Perl module that TFmail.pl needs if you want to use file uploads, unless MIME::Lite is installed on the server</p>

</li>
<li><p>default.trc</p>

<p>The main configuration file</p>

</li>
<li><p>gb.trc</p>

<p>An example configuration file for a guestbook</p>

</li>
<li><p>spage.trt</p>

<p>The template file that controls the layout of the success page</p>

</li>
<li><p>missing.trt</p>

<p>The template file that controls the layout of the page presented to the user if some required fields have been left blank</p>

</li>
<li><p>email.trt</p>

<p>The template file that controls the layout of the email body</p>

</li>
<li><p>README</p>

<p>The *original*, non-Dada-ized Instructions on how to install and use TFmail</p>

</li>
<li><p>EXAMPLES</p>

<p>Some examples of the use of TFmail</p>

</li>
<li><p>FAQ</p>

<p>Some problems and their solutions</p>

</li>
<li><p>ChangeLog</p>

<p>The change history of these files</p>

</li>
<li><p>MANIFEST</p>

<p>List of files</p>

</li>
</ul>

<h1 id="SCRIPT-CONFIGURATION">SCRIPT CONFIGURATION</h1>

<p>There are a number of variables that you can change in TFmail.pl which alter the way that the program works.</p>

<ul>

<li><p>DEBUGGING</p>

<p>This should be set to 1 whilst you are installing and testing the script. Once the script is live you should change it to 0. When set to 1, errors will be output to the browser. This is a security risk and should not be used when the script is live.</p>

</li>
<li><p>LIBDIR</p>

<p>The filesystem path to the location of the .pm files that come with TFmail.pl. See the section below on choosing secure locations for files.</p>

</li>
<li><p>MAILPROG</p>

<p>The command line that the script should use to fire up a program that will read an email message from its standard input, get a list of recipients from the To header and send the email. On most UNIX systems, the correct value will be either:</p>

<pre><code> MAILPROG =&gt; &#39;/usr/lib/sendmail -oi -t&#39;;</code></pre>

<p>or</p>

<pre><code> MAILPROG =&gt; &#39;/usr/sbin/sendmail -oi -t&#39;;</code></pre>

<p>If your system lacks a suitable sendmail program, then you can configure TFmail to talk directly to an SMTP relay rather then using sendmail.</p>

<p>For example, if your ISP has a host called &quot;mailhost.your-isp.net&quot; which will act as an SMTP relay for the web server, you would set:</p>

<pre><code> MAILPROG =&gt; &#39;SMTP:mailhost.your-isp.net&#39;;</code></pre>

</li>
<li><p>POSTMASTER</p>

<p>The email address to use as the &#39;envelope sender&#39; of outgoing e-mails. This address will receive the bounce messages if there is trouble delivering an e-mail, so it&#39;s important to set this. If in doubt, set this to your e-mail address.</p>

</li>
<li><p>CONFIG_ROOT</p>

<p>The filesystem path to the directory that holds all of the configuration files and template files for the script. This must be set to the path to the directory on the server to which you uploaded the .trc and .trt files.</p>

<p>See the section below on choosing secure locations for files.</p>

</li>
<li><p>SESSION_DIR</p>

<p>The location where (if you are using sessions as described below) the session information will be stored. This needs to be a directory in which the user that the TFmail is run as can create and delete files. You may want to consider having this a separate directory as it will make it easier to clean up any orphaned sessions.</p>

<p>Again you should see the section on choosing secure locations for files.</p>

</li>
<li><p>MAX_DEPTH</p>

<p>The depth of subdirectories under CONFIG_ROOT that configuration files and templates may be placed. The default of 0 is fine for most people.</p>

</li>
<li><p>CONFIG_EXT</p>

<p>The file extension that configuration files have. The default of .trc will work with the sample configuration files supplied.</p>

</li>
<li><p>TEMPLATE_EXT</p>

<p>The file extension that template files have. The default of .trt will work with the sample template files supplied.</p>

</li>
<li><p>ENABLE_UPLOADS</p>

<p>Set this to 1 if you wish to use HTTP file uploads to allow users to upload files via the form and have them come through to you as attachments to the email.</p>

</li>
<li><p>USE_MIME_LITE</p>

<p>If you&#39;re not using file uploads then you can set this to 0 to prevent TFmail from using the MIME::Lite perl module. This may speed the script up in some cases, and might be desirable if the e-mail is going to an automated system that doesn&#39;t understand MIME messages. However, the e-mail is more likely to be mangled in some way by mail transport agents if you don&#39;t use MIME::Lite.</p>

</li>
<li><p>LOGFILE_ROOT</p>

<p>The filesystem path to the directory under which log files can be written. Leave this set to the empty string to disable writing to log files.</p>

<p>See the section below on choosing secure locations for files.</p>

</li>
<li><p>LOGFILE_EXT</p>

<p>The file extension that log files must have. Default: .log</p>

</li>
<li><p>HTMLFILE_ROOT</p>

<p>The filesystem path to the directory under which any HTML files that you wish TFmail to modify live. Leave this set to the empty string unless you want to use TFmail to modify HTML files on your server.</p>

</li>
<li><p>HTMLFILE_EXT</p>

<p>The file extension that the HTML files which TFmail modifies must have. Default: .html</p>

</li>
<li><p>CHARSET</p>

<p>The character encoding to use for output documents and e-mails. All user input must be encoded with the same charset or the output may appear garbled. The default of &#39;iso-8859-1&#39; works for many Western languages. If you need characters that iso-8859-1 cannot represent then you might want to consider setting CHARSET to &#39;utf-8&#39;.</p>

</li>
</ul>

<h1 id="SCRIPT-INSTALLATION">SCRIPT INSTALLATION</h1>

<p>TFmail is installed by copying the file TFmail.pl into your cgi-bin directory. If you don&#39;t know where your cgi-bin directory is, then please ask your system administrator.</p>

<p>You must also copy NMStreq.pm and MIME_Lite.pm to the server. You should put them in the location that you configured for LIBDIR above. Leaving LIBDIR set to &#39;.&#39; and uploading the .pm files into your cgi-bin directory will work on most UNIX systems. See the section below on choosing secure locations for files.</p>

<p>You may need to rename TFmail.pl to TFmail.cgi. Again, your system administrator will know if this is the case.</p>

<p>You will probably need to turn on execute permissions to the file. You can do this by running the command &quot;chmod +x TFmail.pl&quot; from your command line. If you don&#39;t have command line access to your web server then there will probably be an equivalent function in your file transfer program.</p>

<h1 id="CHOOSING-SECURE-LOCATIONS-FOR-FILES">CHOOSING SECURE LOCATIONS FOR FILES</h1>

<p>The TFmail.pl CGI requires many support files, such as the .pm files, the .trc configuration files, the .trt output template files and possibly some log files and/or the nms_sendmail script. It&#39;s important to consider security when choosing locations for these files on the web server.</p>

<p>The most important consideration is to prevent an attacker from accessing any of these files directly via the web server, and hence gaining information about your setup or access to your log files. Since your e-mail address appears in the configuration file(s), it&#39;s important to protect them. The log files may contain even more sensitive information.</p>

<p>For example, if you were to put your configuration files in a &#39;tfmail&#39; subdirectory of your web site, then an attacker would be able to read them by typing a URL like</p>

<pre><code>  http://www.your.domain/tfmail/default.trc</code></pre>

<p>into his or her web browser. That&#39;s bad security.</p>

<p>The best place to put all these files is somewhere outside the web server&#39;s document root. That eliminates the whole problem at a single stroke.</p>

<p>However, if you are using an account on a shared web server then you may not have access to any location outside the web server&#39;s document root. In that case, you should put all these support files into a subdirectory of your site to which the web server is configured to deny all access. Your hosting provider should be able to tell you how to block HTTP access to a subdirectory of your site.</p>

<p>If you can&#39;t configure the web server to deny access to a subdirectory of your site, then maybe you can set up a password protected subdirectory. That&#39;s almost as good, so long as you choose a password that nobody will be able to guess.</p>

<p>Finally, if all else fails, a small amount of security can be gained by making the URL to the configuration and other support files hard to guess. For example, if you were to put all the configuration files in a subdirectory of your site but pick the name &#39;p5xltfe&#39; instead of &#39;tfmail&#39;, then the attacker would need to guess the URL:</p>

<pre><code>  http://www.your.domain/p5xltfe/default.trc</code></pre>

<p>which is harder. Be aware however that this is a weak form of security. Web server bugs and configuration errors that allow this type of precaution to be bypassed are relatively common.</p>

<h1 id="THE-CONFIGURATION-SCRIPT">THE CONFIGURATION SCRIPT</h1>

<p>If you wish, you can upload the TFmail_config.pl script and use that to interactively create all the .trt and .trc files that you&#39;ll need, instead of editing and uploading the .trt and .trc files.</p>

<p>See the comments at the top of TFmail_config.pl for directions as to how to configure that script.</p>

<p>TFmail_config.pl is quite new, and should be considered to be an experimental feature.</p>

<h1 id="OUTPUT-CUSTOMIZATION">OUTPUT CUSTOMIZATION</h1>

<p>The .trt files are templates used by TFmail to generate the output HTML and the body of the email. You can edit them to change the look of the output before uploading them to the CONFIG_ROOT directory.</p>

<p>The character combinations &quot;{=&quot; and &quot;=}&quot; are used to mark template directives. Whenever TFmail encounters a template directive, it replaces it with a value. For example, the template directive {= date =} will be replaced with the current date. There are also directives for introducing environment variables and CGI form input values, and a few others.</p>

<p>For example, by default TFmail will use the template email.tft to generate the body of the email. By default that template looks like this:</p>

<pre><code>    %% NMS email template file %%
    Below is the result of your feedback form.  It was submitted
    {= by_submitter =}on {= date =}.
    ----------------------------------------------------------------------
    
    {= FOREACH input_field =}
    {= name =}: {= value =}
    
    {= END =}
    ----------------------------------------------------------------------</code></pre>

<p>The first line just tells TFmail that this is indeed a template file for an email body - it won&#39;t be included in the output.</p>

<p>The {= by_submitter =} directive generates the user&#39;s email address and real name followed by the string &quot;by &quot;, if there are email address and realname inputs in the form. If TFmail can&#39;t work out the user&#39;s email address then the {= by_submitter =} directive produces nothing. The &quot;by &quot; string was made part of the directive output so that the sentence would make sense in either case. The word &#39;by&#39; can be replaced by setting the &quot;by_submitter_by&quot; configuration directive to the required text.</p>

<p>The {= FOREACH input_field =} directive repeats the lines between the FOREACH line and the END line for each field in the form who&#39;s name starts with a letter or a number.</p>

<p>If everything goes OK and the email is sent, TFmail presents a success page to the user. By default, that success page comes from the spage.trt template file, which defaults to this:</p>

<pre><code>    %% NMS html template file %%
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
      &lt;head&gt;
        &lt;title&gt;Thank You&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/nms.css&quot; /&gt;
        &lt;style&gt;
           h1.title {
                       text-align : center;
                    }
        &lt;/style&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;h1 class=&quot;title&quot;&gt;Thank You&lt;/h1&gt;
        &lt;p&gt;Below is what you submitted on {= date =}&lt;/p&gt;
        &lt;hr size=&quot;1&quot; width=&quot;75%&quot; /&gt;
    {= FOREACH input_field =}
        &lt;p&gt;&lt;b&gt;{= name =}:&lt;/b&gt; {= value =}&lt;/p&gt;
    {= END =}
        &lt;hr size=&quot;1&quot; width=&quot;75%&quot; /&gt;
        &lt;p align=&quot;center&quot;&gt;
          &lt;font size=&quot;-1&quot;&gt;
            &lt;a href=&quot;http://nms-cgi.sourceforge.net/&quot;&gt;TFmail&lt;/a&gt;
            &amp;copy; 2002 London Perl Mongers
          &lt;/font&gt;
        &lt;/p&gt;
      &lt;/body&gt;
    &lt;/html&gt;</code></pre>

<p>You can change these templates to anything you like, giving you full control over the look of the output. You don&#39;t have to include the {= FOREACH input_field =} directive or the {= date =} directive unless you want to.</p>

<p>You can use &quot;param&quot; directives to get at the values of individual CGI parameters. The directive {= param.foo =} will output the value of the &quot;foo&quot; CGI parameter, if there is one.</p>

<p>For example, if your HTML form has only two inputs, &quot;name&quot; and &quot;age&quot;, then your success page template file might look like this:</p>

<pre><code>    %% NMS html template file %%
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
      &lt;head&gt;
        &lt;title&gt;Thank You&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;h1&gt;Thank You {= param.name =}&lt;/h1&gt;
        &lt;p&gt;
          Thanks {= param.name =} for registering your age
          as &lt;b&gt;{= param.age =}&lt;/b&gt;.  Your results have been
          added to our database.
        &lt;/p&gt;
      &lt;/body&gt;
    &lt;/html&gt;</code></pre>

<p>In a similar way, you can access the CGI environment variables via &quot;env&quot; template directives. For example:</p>

<pre><code>    %% NMS html template file %%
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
        &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
      &lt;head&gt;
        &lt;title&gt;Thank You&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;h1&gt;Thank You {= param.name =}&lt;/h1&gt;
        &lt;p&gt;
          Thanks {= param.name =} for registering your age
          as &lt;b&gt;{= param.age =}&lt;/b&gt;.  Your results have been
          added to our database.
        &lt;/p&gt;
        &lt;p&gt;
          Note: we have logged your IP address as {= env.REMOTE_ADDR =},
          and we will be reporting you to the FBI if you lied about
          your age.  Have a nice day.
        &lt;/p&gt;
      &lt;/body&gt;
    &lt;/html&gt;</code></pre>

<p>You can also use these &quot;param&quot; and &quot;env&quot; template directives in the email template, to get finer control over the body of the email.</p>

<h1 id="CONFIGURATION-FILES">CONFIGURATION FILES</h1>

<p>TFmail reads its configuration from a configuration file. By default, that file is default.trc in whatever directory you set for CONFIG_ROOT above.</p>

<p>If you have several forms on your site using TFmail, each will need its own configuration file. You can control TFmail&#39;s choice of configuration file via the &quot;_config&quot; hidden form field. For example, if you added the line:</p>

<pre><code>  &lt;input type=&quot;hidden&quot; name=&quot;_config&quot; value=&quot;foo&quot; /&gt;</code></pre>

<p>to one of your HTML forms, then TFmail would use foo.trc in the CONFIG_ROOT directory as its configuration file when processing that form.</p>

<p>The choice of configuration file is the only thing that can be configured via a hidden form field.</p>

<p>The first line of the configuration file has to be exactly the text:</p>

<pre><code>  %% NMS configuration file %%</code></pre>

<p>Lines starting with &#39;#&#39; are ignored, and configuration values are set by putting the name of the configuration setting at the start of a line, followed by a &#39;:&#39; character, followed by the value for that setting. The value can be split over several lines.</p>

<p>One configuration value that you must set is &quot;recipient&quot;, the email address to which the form results should be mailed. For example, your configuration file might look like:</p>

<pre><code>    %% NMS configuration file %%
    #
    # This is my configuration file
    #
    recipient: me@my.domain</code></pre>

<p>You can have several recipients set, in which case the form results will be copied to all of them:</p>

<pre><code>    %% NMS configuration file %%
    #
    # This is my configuration file
    #
    recipient: me@my.domain, some-else@my.domain</code></pre>

<p>Other things that can be set in the configuration file are:</p>

<ul>

<li><p>email_template</p>

<p>The template file to use for the body of the email. Default: email</p>

</li>
<li><p>success_page_template</p>

<p>The template file to use for the main HTML success page, displayed when the email has been sent. Default: spage</p>

</li>
<li><p>sort</p>

<p>This sets the order in which the {= FOREACH input_field =} directive processes the CGI parameters. It can be the string &#39;alphabetic&#39; for alphabetic order, or the string &quot;order:&quot; followed by a comma separated list of the parameter names. Default: the parameters are output in the order in which they occur in the HTTP request.</p>

</li>
<li><p>print_blank_fields</p>

<p>If this is set to a true value then fields that the user left blank will be visited by the {= FOREACH input_field =} directive. Normally, blank fields are suppressed to save space. Default: 0</p>

</li>
<li><p>subject</p>

<p>The subject for the email. Default: &quot;WWW Form Submission&quot;. Template directives can be included in the subject value, see the section on OUTPUT CUSTOMIZATION below.</p>

</li>
<li><p>email_input</p>

<p>The name of the CGI parameter that will hold the user&#39;s email address. Used by TFmail to set the From field of the email. Default: no email_input, the mail comes from POSTMASTER.</p>

</li>
<li><p>realname_input</p>

<p>The name of the CGI parameter that will hold the user&#39;s full name. Used by TFmail to set the comment part of the From field of the email if a valid email address was found in the email_input input. Default: none, so there will be no comment on the From address. If you list several inputs here then their values will be concatenated to make up the comment.</p>

</li>
<li><p>by_submitter_by</p>

<p>The phrase added by the {= by_submitter =} template directive when outputting the user&#39;s email address. Default: &#39;by&#39;.</p>

</li>
<li><p>redirect</p>

<p>If this configuration value is set, then it must be a URL and TFmail will generate a redirect to that URL on success, instead of using the success page template.</p>

</li>
<li><p>required</p>

<p>A comma separated list of the names of inputs that the user cannot leave blank. If any of these are blank, then the submission will not be accepted and &#39;missing_template&#39; be displayed. Default: no fields are required.</p>

</li>
<li><p>missing_template</p>

<p>The HTML template file used to generate the page that the user sees if they leave a required field blank. Default: missing.</p>

</li>
<li><p>missing_fields_redirect</p>

<p>If this configuration value is set then it must be a URL and TFmail will generate a redirect to that URL instead of using a template if the user leaves a required field blank. Default: display template.</p>

</li>
<li><p>confirmation_template</p>

<p>If this field is set then it must be the name of an email template that will be used to send a mail back to the user confirming their submission. CAUTION: since the user could give any email address (not just their own) and submit repeatedly, there is a risk that some nasty person will use this to mailbomb a third party. Only switch this on if you really need it. Template directives that depend on user input will be disabled for this template, so that this feature can&#39;t be used to send SPAM. Default: no confirmation email.</p>

</li>
<li><p>confirmation_subject</p>

<p>The subject for the confirmation email, if it is activated by the confirmation_template directive above.</p>

</li>
<li><p>confirmation_email_from</p>

<p>The email address that the confirmation will have as the From: address. Default is the value of POSTMASTER as configured in the TFmail program itself.</p>

</li>
<li><p>logfile</p>

<p>The name of a file to which data will be appended for each successful run of the script. The name is relative to the LOGFILE_ROOT directory and does not include the LOGFILE_EXT file extension. Default: no logging. Note that logging is disabled unless the LOGFILE_ROOT constant in the script is set.</p>

</li>
<li><p>log_template</p>

<p>The template file used to construct the text that gets appended to the log file if the logfile setting above is set. Default: log</p>

<p>See WRITING TO A LOG FILE below.</p>

</li>
<li><p>modify_html_files</p>

<p>A list of the names of one or more HTML files into which TFmail should insert text, relative to the HTMLFILE_ROOT directory and without the HTMLFILE_EXT file extension. See the section below on inserting text into HTML files.</p>

</li>
<li><p>no_email</p>

<p>Set this to a true value to prevent the main e-mail from being sent. You might wish to do that if you&#39;re using TFmail.pl to record data to a log file and don&#39;t need it mailed as well.</p>

</li>
<li><p>date_fmt</p>

<p>The format that the date will be displayed in. This is a string that contains a number of different &#39;tags&#39;. Each tag consists of a % character followed by a letter. Each tag represents one way of displaying a particular part of the date or time. Here are some common tags:</p>

<ul>

<li><p>%Y</p>

<p>four digit year (2002)</p>

</li>
<li><p>%y</p>

<p>two digit year (02)</p>

</li>
<li><p>%m</p>

<p>month of the year (01 to 12)</p>

</li>
<li><p>%b</p>

<p>short month name (Jan to Dec)</p>

</li>
<li><p>%B</p>

<p>long month name (January to December)</p>

</li>
<li><p>%d</p>

<p>day of the month (01 to 31)</p>

</li>
<li><p>%a</p>

<p>short day name (Sun to Sat)</p>

</li>
<li><p>%A</p>

<p>long day name (Sunday to Saturday)</p>

</li>
<li><p>%H</p>

<p>hour in 24 hour clock (00 to 23)</p>

</li>
<li><p>%I</p>

<p>hour in 12 hour clock (01 to 12)</p>

</li>
<li><p>%p</p>

<p>AM or PM</p>

</li>
<li><p>%M</p>

<p>minutes (00 to 59)</p>

</li>
<li><p>%S</p>

<p>seconds (00 to 59)</p>

</li>
<li><p>%Z</p>

<p>the name of the local timezone</p>

</li>
</ul>

<p>Default: &#39;%A, %B %d, %Y at %H:%M:%S&#39;</p>

</li>
<li><p>bad_method_status</p>

<p>if this is set to 1 then TFmail will return the Status code for &quot;Request Method Not Allowed&quot; rather than an error page if the Request Method is not &#39;POST&#39; (optionally &#39;GET&#39;</p>

<p>see the items &#39;get_redirect&#39; and &#39;get_template&#39; below) you may want to use this if your server is configured to give custom error messages. The default value is 0 meaning the default error page will be displayed.</p>

</li>
<li><p>bad_method_template</p>

<p>If this is set then the template will be used as the content when bad_method_status = 1 and the request method is invalid (see above.)</p>

</li>
<li><p>get_redirect</p>

<p>Normally TFmail will only accept a &#39;POST&#39; method however if this is set to a valid URL then it will redirect to the indicated page on a &#39;GET&#39; request, you could for example use this to cause a redirection to your form if someone has bookmarked the results of a previous request. See also &#39;get_template&#39; below.</p>

</li>
<li><p>get_template</p>

<p>If this is set then it must specify a valid template that will be used when a &#39;GET&#39; request is used, the template will be filled in the same way as the success page but no further action (such as sending mail or writing a log) will be taken. This might be useful when creating a multipage form for example or if you wanted to have a link to a partly prefilled form. If both this and &#39;get_redirect&#39; are specified then the &#39;get_redirect&#39; will take precedence. If this is set then it is possible to use the session capabilities as described in the items below.</p>

</li>
<li><p>session_cookies</p>

<p>If this is set to 1 and get_template is set then when the templated page is sent out in response to a GET request a session is created and a Cookie is sent with the Session Id which will be checked when a POST request is sent</p>

<p>TFmail will abort if the session does not exist or there is no SessionID cooke. Some users may turn off cookies in their browser settings, if this is a problem to you then you might want to see session_field below.</p>

</li>
<li><p>session_field</p>

<p>this can be set to the name of a hidden field on your templated form that will contain the session id when the form is posted. If this is set then for a GET request the template directive {= session_id =} will be available and contain the Session ID</p>

<p>you would want to create a field like:</p>

<pre><code> &lt;input type=&quot;hidden&quot; name=&quot;SessionID&quot;
      value=&quot;{= session_id =}&quot; /&gt;</code></pre>

<p>where you have session_field set to SessionID.</p>

</li>
<li><p>address_style</p>

<p>This will specify the style of the address that is used in the From: address of the main mail message. The default (and the previous style before this option was added) is to create a form of &quot;$email ($realname)&quot;, if it is set to a value of 1 then the address will be generated as &quot;$realname &lt;$email&gt;&quot;. You may want to use this if you are using a mail client that takes the same address in the two perfectly valid styles to be different and you want to sort by From address, for instance.</p>

</li>
<li><p>locale</p>

<p>This when set will determine the locale which is used when determining the names of months and days when using {= date =} template directive the default is to use the locale set on the server. A few examples of locale codes are:</p>

<pre><code>    Catalan           ca_ES
    Croatian          hr_HR
    Czech             cs_CZ
    Danish            da_DK
    Dutc              nl_NL
    Estonian          et_EE
    Finnish           fi_FI
    French            fr_FR
    Galician          gl_ES
    German            de_DE
    Greek             el_GR
    Hebrew            he_IL
    Hungarian         hu_HU
    Icelandic         is_IS
    Italian           it_IT
    Japanese          ja_JP
    Korean            ko_KR
    Lithuanian        lt_LT
    Norwegian         no_NO
    Polish            pl_PL
    Portuguese        pt_PT
    Romanian          ro_RO
    Russian           ru_RU
    Slovak            sk_SK
    Slovenian         sl_SI
    Spanish           es_ES
    Swedish           sv_SE
    Thai              th_TH
    Turkish           tr_TR</code></pre>

<p>This is not a complete list and your server may support a different set.</p>

</li>
<li><p>recipient_input</p>

<p>This specifies the name of a form field that the recipient is taken from. It takes precedence over any recipient specified in the config. When this is set ALL templating that allows input from the form to be introduced into the mail is switched off and attempting to use a template for the email that does this will result in an error. You should think carefully before using this as it is only intended for a &quot;recommend this page&quot; type scenario and is not generally useful.</p>

</li>
<li><p>no_content</p>

<p>If this configuration is set to 1 then no HTML output will be sent to the browser and instead a 204 status will be sent telling the browser that no content was intended to be sent and it should not update the current view. This could be useful if, for instance you are using a Flash form or you have a small subscription box on your page, on the other hand it may be confusing to the visitor of your web page as they will have no feedback that the submission was successful.</p>

</li>
<li><p>block_lists</p>

<p>This is a space delimited list of DNSBL zones that list open proxies or exploited computers that can be used by spammers or crackers to attempt to anonymously access TFmail, if this is set and the requesting client appears in one of the lists then the request will be refused before any further action is taken the default response status is &#39;403 Forbidden&#39; but this may be altered by setting the block_status configuration directive. Care should be taken in using this item as a lookup on a nonexistent or overloaded zone could block for some time. More information on DNSBL and useful zones can be found in README.dnsbl you got with TFmail.</p>

</li>
<li><p>block_status</p>

<p>This will set the status that is returned if one of the configured block_lists has an entry for the requesting host</p>

<p>the default is &#39;403 Forbidden&#39; which is probably appropriate but you may for instance want to use &#39;404 Not Found&#39;, or some other status that will indicate a permanently unsuccessful request. Issuing a status beginning with &#39;2&#39; is almost certainly not appropriate unless for some reason you want to encourage the client to make further requests in the belief that this one was successfull.</p>

</li>
<li><p>blocked_template</p>

<p>If this is set to a valid template file (as described above) and block_lists is set then this will be displayed when the client is blocked.</p>

</li>
<li><p>counter_file</p>

<p>If this is set to the name of a writable file then the {= counter =} directive is enabled. the first time it is referenced in a single request it will be incremented</p>

</li>
</ul>

<h1 id="Dada-Mail-Hooks-in-the-Configuration-Files">Dada Mail Hooks in the Configuration Files</h1>

<p>Once you have TFmail.pl running well without the Dada Mail hooks, it&#39;s a good time to add them. The Dada Mail hooks for TFMail are simply configuration name/value pairs, like the ones above.</p>

<p>In you form, you&#39;ll basically want to pick an <b>email address</b> that will be submitted from the form itself, and either <b>subscribe</b> the email address to a <b>list</b> or, <b>send a confirmation email</b> to the email address for a <b>list</b>.</p>

<p>The trick is to tell Dada Mail where all this information is coming from. Easy enough.</p>

<p>In your <b>configuration template</b>, the value set for, <b>email_input</b> will be the email address that the Dada Mail hooks will use. If you set, <b>email_input</b> like so:</p>

<pre><code> email_input:    email</code></pre>

<p>in your configuration template file, and your form looks like this:</p>

<pre><code> &lt;input type=&quot;text&quot; name=&quot;email&quot; /&gt; </code></pre>

<p>and a person fills out this field with, <i>me@example.com</i>, Dada Mail will work with, <b>me@example.com</b>. Hope that&#39;s clear.</p>

<p>The Dada Mail hooks introduce <b>one</b> new configuration name/value pair. It is:</p>

<ul>

<li><p>dada_mail_list</p>

<p>Set this to the <b>listshortname</b> you want to work with. For example:</p>

<pre><code> dada_mail_list: mylist</code></pre>

</li>
</ul>

<p>In the form itself, you&#39;ll also need to have one of two fields, named either:</p>

<ul>

<li><p>dada_mail_subscribe_email</p>

<p>Set to either, <b>1</b> or, <b>yes</b> if you&#39;d like the email address submitted in the form to be subscribed to your Dada Mail list.</p>

<p>You may want to have this formfield a checkbox, so that the person filling out the form can make the choice themselves:</p>

<pre><code>         &lt;input type=&quot;checkbox&quot; name=&quot;dada_mail_subscribe_email&quot; value=&quot;1&quot; /&gt; Yes! Add my email to your list!</code></pre>

</li>
<li><p>dada_mail_confirm_email</p>

<p>Set to either, <b>1</b> or, <b>yes</b>. Similar to the, <b>dada_mail_subscribe_email</b> field, but rather than subscribing an email address, the address will be sent a confirmation email for the subscription.</p>

<p><b>This is the prefered behavior</b>.</p>

</li>
</ul>

<p>These two form fields, <b>are</b> form fields, so that they are toggle-able - always give the form-filler-outer a chance to say, <i>yes</i> or <i>no</i>.</p>

<p>As far as Dada Mail hooks go - you are done. Wasn&#39;t too hard, no?</p>

<h1 id="Reqular-Expressions-for-Required-Form-Fields-in-Configuration-Files">Reqular Expressions for Required Form Fields in Configuration Files</h1>

<p>Another tweak that makes the Dada-ized TFmail.pl somewhat different than the original TFmail.pl is that there&#39;s a simple way to validate the actual values of the form field.</p>

<p>For example, let&#39;s use an example of one of the Dada Mail-specific form fields, <b>dada_mail_confirm_email</b>.</p>

<p>Let&#39;s say we want this field to be, <b>required</b>, and also want it to be either, <b>1</b>, for, <i>Yes! Send me a confirmation to subscribe!</i> or, <b>0</b> for, <i>No thanks!</i></p>

<p>A snippet of the HTML form itself may look like this:</p>

<pre><code> &lt;p&gt;
  &lt;input type=&quot;radio&quot; name=&quot;dada_mail_confirm_email&quot; value=&quot;1&quot; /&gt;Subscribe to my fancy list!&lt;br /&gt; 
  &lt;input type=&quot;radio&quot; name=&quot;dada_mail_confirm_email&quot; value=&quot;0&quot; /&gt;DO NOT Subscribe  to my fancy list!
 &lt;/p&gt;</code></pre>

<p>Our configuration template would have the following entry:</p>

<pre><code> required: dada_mail_confirm_email</code></pre>

<p>That will tell TFmail that we *need* something for, <b>dada_mail_confirm_email</b>, even if it&#39;s, <b>0</b></p>

<p>Add to this, the following:</p>

<pre><code> required_regex_dada_mail_confirm_email: (1|0)</code></pre>

<p>This is a special, handy-dandy method to pass a regular expression to TFmail, concerning the <b>dada_mail_confirm_email</b> form field.</p>

<p>You can use this for <b>any required field</b>, by adding an entry named, <i><b>required_regex_</b>name_of_you_field</i>:, followed by a regular expression.</p>

<p>For example, Let&#39;s say we have a form field we&#39;d like to have people put in their favorite color, but we&#39;d like only to use the primaries, like red, yellow or blue. In our configuration template, we could put:</p>

<pre><code> required: favorite_color
 required_regex_favorite_color: (red|yellow|blue)</code></pre>

<p>You can probably try to get fancier with the regular expressions, but I&#39;d suggest keeping it pretty simple.</p>

<h1 id="INLINE-TEMPLATES">INLINE TEMPLATES</h1>

<p>If you don&#39;t want to have a separate file for each template, you can choose to put some or all of the templates directly into the configuration file instead, putting a &#39;%&#39; character at the start of each line.</p>

<p>For example, rather than having the configuration file line:</p>

<pre><code> email_template: my_email_template</code></pre>

<p>... and a separate my_email_template.trt file with the text:</p>

<pre><code>    %% NMS email template file %%
    This is the email.
    
    remote address: {= env.REMOTE_ADDR =}
    user agent:     {= env.HTTP_USER_AGENT =}
    referer:        {= env.HTTP_REFERER =}
    
    The name they entered was: {= param.name =}</code></pre>

<p>... you could just have the block:</p>

<pre><code>    email_template:
    %This is the email.
    %
    %remote address: {= env.REMOTE_ADDR =}
    %user agent:     {= env.HTTP_USER_AGENT =}
    %referer:        {= env.HTTP_REFERER =}
    %
    %The name they entered was: {= param.name =}</code></pre>

<p>... in the configuration file. You can do this for any of the configuration variables listed above that expect a template file as a value.</p>

<p>Note that you must leave out the %% NMS ???? template file %% line when using an inline template like this.</p>

<h1 id="WRITING-TO-A-LOG-FILE">WRITING TO A LOG FILE</h1>

<p>If you want to keep your log files in /usr/local/tfmail/logs, then you would set LOGFILE_ROOT to &#39;/usr/local/tfmail/logs&#39;, and you might add the following lines to your .trc file:</p>

<pre><code>    logfile: foo
    log_template:
    %{= date =}|{= env.REMOTE_ADDR =}|{= param.email =}</code></pre>

<p>One problem with log files done this way is that the values input by the user can contain &#39;|&#39; and newline characters, so it&#39;s possible for a malicious user to mess up your log files.</p>

<p>However, TFmail will change tag-like constructs such as &quot;&lt;foo&gt;&quot; found in the user input into &quot;&lt; foo&gt;&quot; when it writes the log file, so using an HTML-like format for log files makes them more resilient:</p>

<pre><code>    logfile: foo
    log_template:
    %{= date =}&lt;x&gt;{= env.REMOTE_ADDR =}&lt;x&gt;{= param.email =}&lt;eol&gt;</code></pre>

<h1 id="FILE-UPLOADS">FILE UPLOADS</h1>

<p>To enable file uploads, you will need to set the ENABLE_UPLOADS constant in the script to 1. You will also need to set the correct encoding in your HTML form:</p>

<pre><code> &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;/cgi-bin/TFmail.pl&quot;&gt;
 ...</code></pre>

<p>...and you will need to configure one or more inputs to be file uploads in your configuration file. The configuration directive to make an input act as a file upload is upload_*, with the * replaced by the name of the input. The value is a list of acceptable file extensions for the uploaded file, with the last one being the default that gets used if the uploaded file has another extension.</p>

<p>For example, suppose you want the user to be able to upload a picture. You might put in the configuration file:</p>

<pre><code> upload_picture: gif jpg jpeg png xxx</code></pre>

<p>and you might put in the HTML form:</p>

<pre><code>  A picture of yourself:
  &lt;input type=&quot;file&quot; name=&quot;picture&quot; /&gt;</code></pre>

<p>If you want the MIME content-type of the upload to be recorded in the email, then you should add:</p>

<pre><code>  {= content_type.picture =}</code></pre>

<p>to the email template file.</p>

<h1 id="INSERTING-TEXT-INTO-HTML-FILES">INSERTING TEXT INTO HTML FILES</h1>

<p>As well as sending email and writing log files, TFmail can be made to insert some text into the middle of an existing HTML file. The HTMLFILE_ROOT constant in the script should be set to the filesystem path under which all of the HTML files that you might want TFmail to modify reside.</p>

<p>For example, to use TFmail.pl as a guestbook script, with your guestbook stored in the file /www/sites/31337/guestbook.html, you might set the HTMLFILE_ROOT constant to &#39;/www/sites/31337&#39; and put the following in a guestbook.trc file:</p>

<pre><code>    %% NMS configuration file %%
    
    no_email: 1
    
    modify_html_files: guestbook
    
    htmlfile_template_guestbook:
    %   &lt;p&gt;&lt;b&gt;Date:&lt;/b&gt;{= date =}&lt;/p&gt;
    %   &lt;p&gt;&lt;b&gt;Name:&lt;/b&gt;{= param.name =}&lt;/p&gt;
    %   &lt;p&gt;&lt;b&gt;Comments:&lt;/b&gt;{= param.comments =}&lt;/p&gt;
    %   &lt;hr /&gt;
    
    required: name,comments
    
    missing_template:
    %&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    %&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
    % &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    %&lt;html&gt;
    % &lt;head&gt;
    %  &lt;title&gt;Missing Fields&lt;/title&gt;
    %  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/nms.css&quot; /&gt;
    % &lt;/head&gt;
    % &lt;body&gt;
    %  &lt;p&gt;
    %   You must fill in both the &lt;b&gt;name&lt;/b&gt; and &lt;b&gt;comments&lt;/b&gt; fields.
    %   Please try again.
    %  &lt;/p&gt;
    %  &lt;form method=&quot;post&quot;&gt;
    %   &lt;input type=&quot;hidden&quot; name=&quot;_config&quot; value=&quot;guestbook&quot; /&gt;
    %   &lt;p&gt;Your Name: &lt;input type=&quot;text&quot; name=&quot;name&quot; size=&quot;30&quot; value=&quot;{= param.name =}&quot; /&gt;&lt;/p&gt;
    %   &lt;p&gt;
    %    Comments:&lt;br /&gt;
    %    &lt;textarea name=&quot;comments&quot; cols=&quot;60&quot; rows=&quot;4&quot;&gt;{= param.comments =}&lt;/textarea&gt;
    %   &lt;/p&gt;
    %   &lt;p&gt;&lt;input type=&quot;submit&quot; /&gt; * &lt;input type=&quot;reset&quot; /&gt;&lt;/p&gt;
    %  &lt;/form&gt;
    %  &lt;hr /&gt;
    % &lt;/body&gt;
    %&lt;/html&gt;
    
    redirect: http://www.your.domain/thankyou.html</code></pre>

<p>... and you might put something like this in the guestbook.html file:</p>

<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
     &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
     &lt;head&gt;
      &lt;title&gt;Guestbook&lt;/title&gt;
      &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/nms.css&quot; /&gt;
     &lt;/head&gt;
     &lt;body&gt;
      &lt;h1&gt;Guestbook&lt;/h1&gt;
      &lt;p&gt;Thank you for visiting our pages.  We would love it if you would
       &lt;a href=&quot;addguest.html&quot;&gt;Add&lt;/a&gt; to this guestbook we are keeping!&lt;/p&gt;
      &lt;hr /&gt;
    &lt;!-- NMS insert below --&gt;
     &lt;/body&gt;
    &lt;/html&gt;</code></pre>

<p>... and addguest.html would probably look something like:</p>

<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;
    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
     &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
    &lt;html&gt;
     &lt;head&gt;
      &lt;title&gt;Add to our Guestbook&lt;/title&gt;
      &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/nms.css&quot; /&gt;
     &lt;/head&gt;
     &lt;body&gt;
      &lt;h1&gt;Add to our Guestbook&lt;/h1&gt;
      &lt;p&gt;Fill in the blanks below to add to our guestbook.&lt;/p&gt;
      &lt;hr /&gt;
      &lt;form method=&quot;post&quot; action=&quot;http://www.your.domain/cgi-bin/TFmail.pl&quot;&gt;
       &lt;input type=&quot;hidden&quot; name=&quot;_config&quot; value=&quot;guestbook&quot; /&gt;
       &lt;p&gt;Your Name: &lt;input type=&quot;text&quot; name=&quot;name&quot; size=&quot;30&quot; /&gt;&lt;/p&gt;
       &lt;p&gt;Comments:&lt;br /&gt;&lt;textarea name=&quot;comments&quot; cols=&quot;60&quot; rows=&quot;4&quot;&gt;&lt;/textarea&gt;&lt;/p&gt;
       &lt;p&gt;&lt;input type=&quot;submit&quot; /&gt; * &lt;input type=&quot;reset&quot; /&gt;&lt;/p&gt;
      &lt;/form&gt;
      &lt;hr /&gt;
     &lt;/body&gt;
    &lt;/html&gt;</code></pre>

<h1 id="ADVANCED-GUESTBOOK">ADVANCED GUESTBOOK</h1>

<p>The trouble with the guestbook scheme described above is that it writes the entries directly into the guestbook HTML file, so you can&#39;t change the style in which the entries are shown without going back and editing all the old entries by hand.</p>

<p>There is an alternative scheme, using the script GBview.pl, which formats the guestbook when it is displayed. GBview.pl also allows you to split a long guestbook into multiple pages.</p>

<p>To use the GBview scheme, adapt the example GBview configuration file supplied as gb.trc to your requirements, and upload it. You will also need to edit the configuration section of GBview.pl and upload it to the same place as TFmail.pl. Give all the configuration constants in GBview.pl the same values that you used for TFmail.pl.</p>

<p>You will need to have the HTMLFILE_ROOT configuration constant set in both TFmail and GBview. Since the HTML file that TFmail rewrites isn&#39;t viewed directly by the user in this case, it&#39;s best to set HTMLFILE_ROOT to a location outside of the web server&#39;s document root. See the section on CHOOSING SECURE LOCATIONS FOR FILES above.</p>

<p>You will need an addguest.html file, such as the one shown in the example above. You must change the value of the hidden &quot;_config&quot; input to &quot;gb&quot; in the HTML form. You will also need to upload an empty gbdata.html file to the HTMLFILE_ROOT directory on the server.</p>

<p>See http://cleaton.net/nms/agb.html for a working example of a guestbook of this type.</p>

<h1 id="SUPPORT">SUPPORT</h1>

<p>For support of this script please email:</p>

<pre><code>  &lt;nms-cgi-support@lists.sourceforge.net&gt;</code></pre>


</body>

</html>


